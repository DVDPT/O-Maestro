#include "Goertzel.h"

#define GOERTZEL_NR_OF_FREQUENCIES (88)
#define GOERTZEL_NR_OF_BLOCKS (6)
#define GOERTZEL_FREQUENCY_MAX_N (179)
#define GOERTZEL_CONTROLLER_BUFFER_SIZE (8000)
#define GOERTZEL_CONTROLLER_FS (8800)
#define GOERTZEL_CONTROLLER_SAMPLES_TYPE short

GoertzelFrequency const block0Freqs[] = 
{
	{ 27.5, 1.61803398874989 },
	{ 29.1352, 1.57299463233049 },
	{ 30.8677, 1.52288145852962 },
	{ 32.7032, 1.46718785998182 },
	{ 34.6478, 1.40537146919054 },
	{ 36.7081, 1.33685359251794 },
	{ 38.8909, 1.26103400535143 },
	{ 41.2034, 1.17729258187869 },
	{ 43.6535, 1.08498864045419 },
	{ 46.2493, 0.983493701829211 },
	{ 48.9994, 0.87220068003704 },
	{ 51.9131, 0.750541011507307 },
	{ 55, 0.618033988749895 },
	{ 58.2705, 0.474307674113196 },
	{ 61.7354, 0.319167936733305 },
};
double const block0filterValues[] = 
{
	0.00451035839949659,
	0.00563079054465151,
	0.0077956992076632,
	0.0109593086470615,
	0.0150254585064863,
	0.0198512729359433,
	0.0252532779787125,
	0.031015680682925,
	0.0369004055955893,
	0.0426583873406868,
	0.0480415472803028,
	0.0528148417994259,
	0.0567677618881482,
	0.0597246889877363,
	0.0615535692722635,
	0.0621724546570805,
	0.0615535692722635,
	0.0597246889877363,
	0.0567677618881482,
	0.0528148417994259,
	0.0480415472803028,
	0.0426583873406868,
	0.0369004055955893,
	0.031015680682925,
	0.0252532779787125,
	0.0198512729359433,
	0.0150254585064863,
	0.0109593086470615,
	0.0077956992076632,
	0.00563079054465151,
	0.00451035839949659,
};
GoertzelFrequeciesBlock const block0 = { 275, 137, 32, 15,(double*)block0filterValues,(GoertzelFrequency*)block0Freqs };
GoertzelFrequency const block1Freqs[] = 
{
	{ 65.4064, 1.46718785998182 },
	{ 69.2957, 1.40536984355741 },
	{ 73.4162, 1.33685359251794 },
	{ 77.7817, 1.2610357787521 },
	{ 82.4069, 1.17729073487114 },
	{ 87.3071, 1.08498672109009 },
	{ 92.4986, 0.983493701829211 },
	{ 97.9989, 0.872198623954223 },
	{ 103.826, 0.750545247127781 },
	{ 110, 0.618033988749895 },
	{ 116.541, 0.474307674113196 },
	{ 123.471, 0.319163425705377 },
	{ 130.813, 0.152635660216125 },
	{ 138.591, -0.0249264643508869 },
	{ 146.832, -0.21281338488139 },
};
double const block1filterValues[] = 
{
	0.00243785241753926,
	0.00349308962484901,
	0.00542199739913158,
	0.00839279152531792,
	0.0124878381990474,
	0.0176926629416599,
	0.0238927369715698,
	0.0308784235421634,
	0.0383577962293719,
	0.0459763887857191,
	0.0533423567624337,
	0.0600550736154224,
	0.0657348874281261,
	0.070051654316176,
	0.0727497510449316,
	0.0736675459121816,
	0.0727497510449316,
	0.070051654316176,
	0.0657348874281261,
	0.0600550736154224,
	0.0533423567624337,
	0.0459763887857191,
	0.0383577962293719,
	0.0308784235421634,
	0.0238927369715698,
	0.0176926629416599,
	0.0124878381990474,
	0.00839279152531792,
	0.00542199739913158,
	0.00349308962484901,
	0.00243785241753926,
};
GoertzelFrequeciesBlock const block1 = { 550, 150, 16, 15,(double*)block1filterValues,(GoertzelFrequency*)block1Freqs };
GoertzelFrequency const block2Freqs[] = 
{
	{ 155.563, 1.2610393255485 },
	{ 164.814, 1.17728888786206 },
	{ 174.614, 1.08498864045419 },
	{ 184.997, 0.983495691286584 },
	{ 195.998, 0.872196567870268 },
	{ 207.652, 0.750545247127781 },
	{ 220, 0.618033988749895 },
	{ 233.082, 0.474307674113196 },
	{ 246.942, 0.319163425705377 },
	{ 261.626, 0.152635660216125 },
	{ 277.183, -0.0249378874364762 },
	{ 293.665, -0.212824743993789 },
	{ 311.127, -0.40979100102747 },
	{ 329.628, -0.613990874516521 },
	{ 349.228, -0.822799650085379 },
};
double const block2filterValues[] = 
{
	-0.00675047671329453,
	-0.00773661456123958,
	-0.00934077430621201,
	-0.0106774610775887,
	-0.010657417955339,
	-0.00818007401383527,
	-0.00234653934531518,
	0.00734430136139875,
	0.0208528567042888,
	0.037537515750063,
	0.0561902148740506,
	0.0751677902514068,
	0.0926013761334415,
	0.106652147798677,
	0.115772973698126,
	0.118933670875399,
	0.115772973698126,
	0.106652147798677,
	0.0926013761334415,
	0.0751677902514068,
	0.0561902148740506,
	0.037537515750063,
	0.0208528567042888,
	0.00734430136139875,
	-0.00234653934531518,
	-0.00818007401383527,
	-0.010657417955339,
	-0.0106774610775887,
	-0.00934077430621201,
	-0.00773661456123958,
	-0.00675047671329453,
};
GoertzelFrequeciesBlock const block2 = { 1100, 126, 8, 15,(double*)block2filterValues,(GoertzelFrequency*)block2Freqs };
GoertzelFrequency const block3Freqs[] = 
{
	{ 369.994, 0.983495691286584 },
	{ 391.995, 0.872201708078022 },
	{ 415.305, 0.750539952601576 },
	{ 440, 0.618033988749895 },
	{ 466.164, 0.474307674113196 },
	{ 493.883, 0.319169064490026 },
	{ 523.251, 0.152641355543374 },
	{ 554.365, -0.0249321758937832 },
	{ 587.33, -0.212824743993789 },
	{ 622.254, -0.40979100102747 },
	{ 659.255, -0.613985438353575 },
	{ 698.456, -0.822799650085379 },
	{ 739.989, -1.03274111677182 },
	{ 783.991, -1.23926866371561 },
	{ 830.609, -1.43668580578722 },
};
double const block3filterValues[] = 
{
	0.000750830512901112,
	0.00196276156952978,
	0.00334757662248245,
	0.00355367715524453,
	3.51276420066289E-05,
	-0.00981885852067101,
	-0.0266632785177693,
	-0.0473792226088591,
	-0.0647772276601034,
	-0.0695627467017687,
	-0.0541369366502563,
	-0.0166545323112567,
	0.0366993792121937,
	0.0926652991513813,
	0.135116612096617,
	0.150944261779687,
	0.135116612096617,
	0.0926652991513813,
	0.0366993792121937,
	-0.0166545323112567,
	-0.0541369366502563,
	-0.0695627467017687,
	-0.0647772276601034,
	-0.0473792226088591,
	-0.0266632785177693,
	-0.00981885852067101,
	3.51276420066289E-05,
	0.00355367715524453,
	0.00334757662248245,
	0.00196276156952978,
	0.000750830512901112,
};
GoertzelFrequeciesBlock const block3 = { 2200, 106, 4, 15,(double*)block3filterValues,(GoertzelFrequency*)block3Freqs };
GoertzelFrequency const block4Freqs[] = 
{
	{ 880, 1.61803398874989 },
	{ 932.328, 1.57299322125469 },
	{ 987.767, 1.52288090312343 },
	{ 1046.5, 1.46719018905845 },
	{ 1108.73, 1.40537106278243 },
	{ 1174.66, 1.3368527428278 },
	{ 1244.51, 1.26103267529985 },
	{ 1318.51, 1.17729119662317 },
	{ 1396.91, 1.08499103965731 },
	{ 1479.98, 0.983490717640743 },
	{ 1567.98, 0.872201708078022 },
	{ 1661.22, 0.750539952601576 },
	{ 1760, 0.618033988749895 },
	{ 1864.66, 0.474302125075554 },
	{ 1975.53, 0.319171883881374 },
};
double const block4filterValues[] = 
{
	-0.00218867180677595,
	-0.000174561548098121,
	-0.000942421781297741,
	-0.00578868119939173,
	-0.00290577211027316,
	0.015386611857731,
	0.0256365223984204,
	0.00700401280890892,
	-0.00520932974029247,
	0.0233632317588853,
	0.0266502084594917,
	-0.0768974880891281,
	-0.190969709087521,
	-0.111244294173982,
	0.149026477438843,
	0.298002728172428,
	0.149026477438843,
	-0.111244294173982,
	-0.190969709087521,
	-0.0768974880891281,
	0.0266502084594917,
	0.0233632317588853,
	-0.00520932974029247,
	0.00700401280890892,
	0.0256365223984204,
	0.015386611857731,
	-0.00290577211027316,
	-0.00578868119939173,
	-0.000942421781297741,
	-0.000174561548098121,
	-0.00218867180677595,
};
GoertzelFrequeciesBlock const block4 = { 8800, 179, 1, 15,(double*)block4filterValues,(GoertzelFrequency*)block4Freqs };
GoertzelFrequency const block5Freqs[] = 
{
	{ 2093, 0.152647050869377 },
	{ 2217.46, -0.0249321758937832 },
	{ 2349.32, -0.212824743993789 },
	{ 2489.02, -0.409796591826102 },
	{ 2637.02, -0.613985438353575 },
	{ 2793.83, -0.822807459405852 },
	{ 2959.96, -1.0327460083145 },
	{ 3135.96, -1.23926418042578 },
	{ 3322.44, -1.43668977954882 },
	{ 3520, -1.61803398874989 },
	{ 3729.31, -1.77503091430041 },
	{ 3951.07, -1.89813380784295 },
	{ 4186.01, -1.97670105124705 },
};
double const block5filterValues[] = 
{
	-0.0016073745671281,
	-6.13951657452795E-05,
	0.00344973568079801,
	0.00191529941324839,
	-0.00564442030713105,
	-0.00865934936969963,
	0.00714437907082772,
	0.0194386507868508,
	0.000370406375112515,
	-0.0370078882799693,
	-0.0204781004043777,
	0.0526446096214455,
	0.0768295309889147,
	-0.0679025744949379,
	-0.306246552896669,
	0.570814222971481,
	-0.306246552896669,
	-0.0679025744949379,
	0.0768295309889147,
	0.0526446096214455,
	-0.0204781004043777,
	-0.0370078882799693,
	0.000370406375112515,
	0.0194386507868508,
	0.00714437907082772,
	-0.00865934936969963,
	-0.00564442030713105,
	0.00191529941324839,
	0.00344973568079801,
	-6.13951657452795E-05,
	-0.0016073745671281,
};
GoertzelFrequeciesBlock const block5 = { 8800, 75, 1, 13,(double*)block5filterValues,(GoertzelFrequency*)block5Freqs };
GoertzelFrequeciesBlock const blocks[] = {
	block0 ,
	block1 ,
	block2 ,
	block3 ,
	block4 ,
	block5 ,
};
GoertzelFrequeciesBlock* goertzelBlocks = (GoertzelFrequeciesBlock*)blocks;
