#include "Goertzel.h"

#define GOERTZEL_NR_OF_FREQUENCIES (88)
#define GOERTZEL_NR_OF_BLOCKS (5)
#define GOERTZEL_FREQUENCY_MAX_N (180)
#define GOERTZEL_CONTROLLER_BUFFER_SIZE (8000)
#define GOERTZEL_CONTROLLER_FS (8800)
#define GOERTZEL_CONTROLLER_SAMPLES_TYPE short

GoertzelFrequency const block0Freqs[] = 
{
	{ 27.5, 1.61803398874989 },
	{ 29.1352, 1.57299463233049 },
	{ 30.8677, 1.52288145852962 },
	{ 32.7032, 1.46718785998182 },
	{ 34.6478, 1.40537146919054 },
	{ 36.7081, 1.33685359251794 },
	{ 38.8909, 1.26103400535143 },
	{ 41.2034, 1.17729258187869 },
	{ 43.6535, 1.08498864045419 },
	{ 46.2493, 0.983493701829211 },
	{ 48.9994, 0.87220068003704 },
	{ 51.9131, 0.750541011507307 },
	{ 55, 0.618033988749895 },
	{ 58.2705, 0.474307674113196 },
	{ 61.7354, 0.319167936733305 },
	{ 65.4064, 0.152640216478023 },
	{ 69.2957, -0.0249356028194235 },
	{ 73.4162, -0.212822472171865 },
	{ 77.7817, -0.409788764707081 },
	{ 82.4069, -0.613986525586564 },
};
double const block0filterValues[] = 
{
	0.00426186963288669,
	0.00537880823920419,
	0.00752091858335536,
	0.0106683090022799,
	0.0147454021662082,
	0.019623334896253,
	0.0251254273472987,
	0.0310354568817105,
	0.0371083035498848,
	0.0430823899335843,
	0.0486932270769041,
	0.0536873072390278,
	0.0578355577624334,
	0.0609455902814486,
	0.0628720448110089,
	0.0635244352084435,
	0.0628720448110089,
	0.0609455902814486,
	0.0578355577624334,
	0.0536873072390278,
	0.0486932270769041,
	0.0430823899335843,
	0.0371083035498848,
	0.0310354568817105,
	0.0251254273472987,
	0.019623334896253,
	0.0147454021662082,
	0.0106683090022799,
	0.00752091858335536,
	0.00537880823920419,
	0.00426186963288669,
};
GoertzelFrequeciesBlock const block0 = { 275, 169, 32, 20,(double*)block0filterValues,(GoertzelFrequency*)block0Freqs };
GoertzelFrequency const block1Freqs[] = 
{
	{ 87.3071, 1.62383005720108 },
	{ 92.4986, 1.57944665718981 },
	{ 97.9989, 1.53005729991621 },
	{ 103.826, 1.47516123956621 },
	{ 110, 1.4142135623731 },
	{ 116.541, 1.34664806010182 },
	{ 123.471, 1.27186380804384 },
	{ 130.813, 1.18924121826799 },
	{ 138.591, 1.09815305143999 },
	{ 146.832, 0.997954657155657 },
	{ 155.563, 0.888037974068225 },
	{ 164.814, 0.767820081287531 },
	{ 174.614, 0.636826762014782 },
	{ 184.997, 0.494654510171902 },
	{ 195.998, 0.341072526870219 },
	{ 207.652, 0.17610068271851 },
	{ 220, 1.22460635382238E-16 },
	{ 233.082, -0.186539002223995 },
	{ 246.942, -0.382362453788225 },
	{ 261.626, -0.585705324772459 },
};
double const block1filterValues[] = 
{
	-0.00186949544805303,
	-0.00138796016021013,
	-0.000547987522464806,
	0.00121617410262396,
	0.00441781021762361,
	0.00943938715150087,
	0.0164668915501772,
	0.0254460690007491,
	0.0360671790330949,
	0.0477813437679254,
	0.0598475334285418,
	0.0714052356406934,
	0.0815644320889489,
	0.0895021208943996,
	0.0945536068539301,
	0.0962872843899261,
	0.0945536068539301,
	0.0895021208943996,
	0.0815644320889489,
	0.0714052356406934,
	0.0598475334285418,
	0.0477813437679254,
	0.0360671790330949,
	0.0254460690007491,
	0.0164668915501772,
	0.00943938715150087,
	0.00441781021762361,
	0.00121617410262396,
	-0.000547987522464806,
	-0.00138796016021013,
	-0.00186949544805303,
};
GoertzelFrequeciesBlock const block1 = { 880, 180, 10, 20,(double*)block1filterValues,(GoertzelFrequency*)block1Freqs };
GoertzelFrequency const block2Freqs[] = 
{
	{ 277.183, 1.40536903074016 },
	{ 293.665, 1.3368527428278 },
	{ 311.127, 1.26103489205197 },
	{ 329.628, 1.17728888786206 },
	{ 349.228, 1.08498864045419 },
	{ 369.994, 0.983495691286584 },
	{ 391.995, 0.872201708078022 },
	{ 415.305, 0.750539952601576 },
	{ 440, 0.618033988749895 },
	{ 466.164, 0.474307674113196 },
	{ 493.883, 0.319169064490026 },
	{ 523.251, 0.152641355543374 },
	{ 554.365, -0.0249321758937832 },
	{ 587.33, -0.212824743993789 },
	{ 622.254, -0.40979100102747 },
	{ 659.255, -0.613985438353575 },
	{ 698.456, -0.822799650085379 },
	{ 739.989, -1.03274111677182 },
	{ 783.991, -1.23926866371561 },
	{ 830.609, -1.43668580578722 },
};
double const block2filterValues[] = 
{
	-0.00145170473691252,
	-0.000654525372444703,
	0.000183036591982036,
	0.000108456073277546,
	-0.00295816081963242,
	-0.0112872503457998,
	-0.0254876394509519,
	-0.0427463847834161,
	-0.0564463099053406,
	-0.0579377284507868,
	-0.0401213911880705,
	-0.00135328595870245,
	0.0523128855397421,
	0.107995662678288,
	0.150029586900569,
	0.165671965884986,
	0.150029586900569,
	0.107995662678288,
	0.0523128855397421,
	-0.00135328595870245,
	-0.0401213911880705,
	-0.0579377284507868,
	-0.0564463099053406,
	-0.0427463847834161,
	-0.0254876394509519,
	-0.0112872503457998,
	-0.00295816081963242,
	0.000108456073277546,
	0.000183036591982036,
	-0.000654525372444703,
	-0.00145170473691252,
};
GoertzelFrequeciesBlock const block2 = { 2200, 142, 4, 20,(double*)block2filterValues,(GoertzelFrequency*)block2Freqs };
GoertzelFrequency const block3Freqs[] = 
{
	{ 880, 1.61803398874989 },
	{ 932.328, 1.57299322125469 },
	{ 987.767, 1.52288090312343 },
	{ 1046.5, 1.46719018905845 },
	{ 1108.73, 1.40537106278243 },
	{ 1174.66, 1.3368527428278 },
	{ 1244.51, 1.26103267529985 },
	{ 1318.51, 1.17729119662317 },
	{ 1396.91, 1.08499103965731 },
	{ 1479.98, 0.983490717640743 },
	{ 1567.98, 0.872201708078022 },
	{ 1661.22, 0.750539952601576 },
	{ 1760, 0.618033988749895 },
	{ 1864.66, 0.474302125075554 },
	{ 1975.53, 0.319171883881374 },
	{ 2093, 0.152647050869377 },
	{ 2217.46, -0.0249321758937832 },
	{ 2349.32, -0.212824743993789 },
	{ 2489.02, -0.409796591826102 },
	{ 2637.02, -0.613985438353575 },
};
double const block3filterValues[] = 
{
	-0.00335398449212751,
	-0.00121943216536964,
	0.00195016892080255,
	-0.00311360741913673,
	0.00437346324054453,
	0.0204023422472348,
	0.0042619126310479,
	0.00867990488449116,
	0.0379923804495631,
	-0.0230134337986369,
	-0.0582790129068306,
	0.00543971107924158,
	-0.12240268923954,
	-0.247739850815629,
	0.134052523536906,
	0.480612425083785,
	0.134052523536906,
	-0.247739850815629,
	-0.12240268923954,
	0.00543971107924158,
	-0.0582790129068306,
	-0.0230134337986369,
	0.0379923804495631,
	0.00867990488449116,
	0.0042619126310479,
	0.0204023422472348,
	0.00437346324054453,
	-0.00311360741913673,
	0.00195016892080255,
	-0.00121943216536964,
	-0.00335398449212751,
};
GoertzelFrequeciesBlock const block3 = { 8800, 179, 1, 20,(double*)block3filterValues,(GoertzelFrequency*)block3Freqs };
GoertzelFrequency const block4Freqs[] = 
{
	{ 2793.83, -0.822807459405852 },
	{ 2959.96, -1.0327460083145 },
	{ 3135.96, -1.23926418042578 },
	{ 3322.44, -1.43668977954882 },
	{ 3520, -1.61803398874989 },
	{ 3729.31, -1.77503091430041 },
	{ 3951.07, -1.89813380784295 },
	{ 4186.01, -1.97670105124705 },
};
double const block4filterValues[] = 
{
	0.00152354227814631,
	-0.0038196189856693,
	0.0037453464202362,
	0.000437116525576889,
	-0.00265105882695256,
	-0.00656850094076883,
	0.0215497830863474,
	-0.0191266782632589,
	-0.0077490858160414,
	0.0227769742304653,
	0.0157171908709982,
	-0.0799408458096717,
	0.0700922657256527,
	0.0761201098115152,
	-0.281359863585561,
	0.378794519896366,
	-0.281359863585561,
	0.0761201098115152,
	0.0700922657256527,
	-0.0799408458096717,
	0.0157171908709982,
	0.0227769742304653,
	-0.0077490858160414,
	-0.0191266782632589,
	0.0215497830863474,
	-0.00656850094076883,
	-0.00265105882695256,
	0.000437116525576889,
	0.0037453464202362,
	-0.0038196189856693,
	0.00152354227814631,
};
GoertzelFrequeciesBlock const block4 = { 8800, 57, 1, 8,(double*)block4filterValues,(GoertzelFrequency*)block4Freqs };
GoertzelFrequeciesBlock const blocks[] = {
	block0 ,
	block1 ,
	block2 ,
	block3 ,
	block4 ,
};
GoertzelFrequeciesBlock* goertzelBlocks = (GoertzelFrequeciesBlock*)blocks;
